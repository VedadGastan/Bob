// ============================================================================
// BOB LANGUAGE COMPREHENSIVE TEST SUITE
// ============================================================================
// This file tests all features of the Bob programming language.
// Each section tests a specific category of functionality.
// ============================================================================

print "===== BOB LANGUAGE TEST SUITE ====="
print ""

// ============================================================================
// 1. BASIC LITERALS AND TYPES
// ============================================================================
print "=== Testing Literals ==="
print 42                    // Number
print 3.14159              // Float
print "Hello, World!"      // String
print true                 // Boolean
print false                // Boolean
print nil                  // Nil
print ""

// ============================================================================
// 2. VARIABLES AND ASSIGNMENT
// ============================================================================
print "=== Testing Variables ==="
let x = 10
print x                    // 10

let y = 20
print y                    // 20

x = 30                     // Reassignment
print x                    // 30

let name = "Alice"
print name                 // Alice

let uninitialized
print uninitialized        // nil
print ""

// ============================================================================
// 3. ARITHMETIC OPERATIONS
// ============================================================================
print "=== Testing Arithmetic ==="
print 5 + 3                // 8
print 10 - 4               // 6
print 6 * 7                // 42
print 20 / 4               // 5
print 17 % 5               // 2 (modulo)
print 2 ** 8               // 256 (exponentiation)
print 2 ** 3 ** 2          // 512 (right associative)
print ""

// ============================================================================
// 4. STRING OPERATIONS
// ============================================================================
print "=== Testing Strings ==="
print "Hello" + " " + "World"              // Concatenation
print "Repeat" * 3                         // Repetition
print "lo" in "Hello"                      // Substring check (true)
print "xyz" in "Hello"                     // false
print ""

// ============================================================================
// 5. COMPARISON OPERATORS
// ============================================================================
print "=== Testing Comparisons ==="
print 5 > 3                // true
print 5 < 3                // false
print 5 >= 5               // true
print 5 <= 4               // false
print 10 == 10             // true
print 10 != 5              // true
print "abc" == "abc"       // true
print "abc" != "xyz"       // true
print ""

// ============================================================================
// 6. LOGICAL OPERATORS
// ============================================================================
print "=== Testing Logical Operators ==="
print true and true        // true
print true and false       // false
print false or true        // true
print false or false       // false
print not true             // false
print not false            // true
print 5 > 3 and 10 < 20   // true
print 5 > 3 or 10 > 20    // true
print ""

// ============================================================================
// 7. UNARY OPERATORS
// ============================================================================
print "=== Testing Unary Operators ==="
print -42                  // -42
print -(10 + 5)           // -15
print not (5 > 10)        // true
print ""

// ============================================================================
// 8. ARRAYS
// ============================================================================
print "=== Testing Arrays ==="
let arr = [1, 2, 3, 4, 5]
print arr                  // [1, 2, 3, 4, 5]

// Array indexing
print arr[0]               // 1
print arr[2]               // 3
print arr[4]               // 5

// Negative indexing
print arr[-1]              // 5
print arr[-2]              // 4

// Nested arrays
let matrix = [[1, 2], [3, 4], [5, 6]]
print matrix               // [[1, 2], [3, 4], [5, 6]]
print matrix[1]            // [3, 4]
print matrix[1][0]         // 3

// Mixed types in arrays
let mixed = [1, "two", 3.0, true, nil]
print mixed                // [1, two, 3, true, nil]
print ""

// ============================================================================
// 9. ARRAY MEMBERSHIP TEST
// ============================================================================
print "=== Testing Array Membership ==="
let numbers = [1, 2, 3, 4, 5]
print 3 in numbers         // true
print 10 in numbers        // false
print ""

// ============================================================================
// 10. IF-ELSE STATEMENTS
// ============================================================================
print "=== Testing If-Else ==="

let score = 85
if score >= 90
    print "Grade: A"
else
    print "Grade: B or lower"
end

if score >= 60
    print "Passing"
end

// Nested if
let temperature = 25
if temperature > 30
    print "Hot"
else
    if temperature > 20
        print "Warm"
    else
        print "Cold"
    end
end
print ""

// ============================================================================
// 11. WHILE LOOPS
// ============================================================================
print "=== Testing While Loops ==="
let counter = 0
while counter < 5
    print counter
    counter = counter + 1
end
print ""

// ============================================================================
// 12. FOR LOOPS
// ============================================================================
print "=== Testing For Loops ==="

// Classic for loop
for (let i = 0; i < 5; i = i + 1)
    print i
end

// For loop with condition only
let j = 0
for (; j < 3;)
    print j
    j = j + 1
end
print ""

// ============================================================================
// 13. FUNCTIONS - BASIC
// ============================================================================
print "=== Testing Functions - Basic ==="

func greet(name)
    print "Hello, " + name + "!"
end

greet("Alice")
greet("Bob")

// Function with return value
func add(a, b)
    return a + b
end

print add(5, 3)            // 8
print add(10, 20)          // 30
print ""

// ============================================================================
// 14. FUNCTIONS - RECURSION
// ============================================================================
print "=== Testing Recursion ==="

func factorial(n)
    if n <= 1
        return 1
    end
    return n * factorial(n - 1)
end

print factorial(5)         // 120
print factorial(6)         // 720

func fibonacci(n)
    if n <= 1
        return n
    end
    return fibonacci(n - 1) + fibonacci(n - 2)
end

print fibonacci(10)        // 55
print ""

// ============================================================================
// 15. FUNCTIONS - CLOSURES
// ============================================================================
print "=== Testing Closures ==="

func makeCounter()
    let count = 0
    func increment()
        count = count + 1
        return count
    end
    return increment
end

let counter1 = makeCounter()
print counter1() // 1
print counter1() // 2
print counter1() // 3

let counter2 = makeCounter()
print counter2() // 1
print counter1() // 4
print ""

// ============================================================================
// 16. BUILT-IN FUNCTIONS
// ============================================================================
print "=== Testing Built-in Functions ==="

// len() function
print len([1, 2, 3, 4, 5])        // 5
print len("Hello")                 // 5
print len([])                      // 0

// Math functions
print sqrt(16)                     // 4
print sqrt(2)                      // 1.41421...
print pow(2, 10)                   // 1024
print abs(-42)                     // 42
print abs(42)                      // 42
print floor(3.7)                   // 3
print ceil(3.2)                    // 4

// Trigonometric functions
print sin(0)                       // 0
print cos(0)                       // 1
print ""

// ============================================================================
// 17. SCOPING
// ============================================================================
print "=== Testing Scoping ==="

let global = "I am global"

func testScope()
    let local = "I am local"
    print global               // Can access global
    print local                // Can access local
end

testScope()
print global                   // Can access global

// Shadowing
let x = "outer"
if true
    let x = "inner"
    print x                    // inner
end
print x                        // outer
print ""

// ============================================================================
// 18. COMPLEX EXPRESSIONS
// ============================================================================
print "=== Testing Complex Expressions ==="

// Order of operations
print 2 + 3 * 4                // 14
print (2 + 3) * 4              // 20
print 2 ** 3 + 1               // 9
print 2 ** (3 + 1)             // 16

// Chained comparisons (as separate expressions)
print 5 > 3 and 3 > 1          // true
print 10 >= 10 and 10 <= 10    // true
print ""

// ============================================================================
// 19. EDGE CASES
// ============================================================================
print "=== Testing Edge Cases ==="

// Empty array
let empty = []
print len(empty)               // 0

// String escape sequences
print "Line 1\nLine 2"         // Newline
print "Tab\there"              // Tab
print "Quote: \"Hello\""       // Escaped quote

// Boolean arithmetic contexts
if 0
    print "This won't print"
end

if 1
    print "Non-zero is truthy"
end

if ""
    print "This won't print"
end

if "text"
    print "Non-empty string is truthy"
end
print ""

// ============================================================================
// 20. PRACTICAL EXAMPLES
// ============================================================================
print "=== Practical Examples ==="

// Example 1: Sum of array
func sumArray(arr)
    let sum = 0
    let i = 0
    while i < len(arr)
        sum = sum + arr[i]
        i = i + 1
    end
    return sum
end

print sumArray([1, 2, 3, 4, 5])    // 15

// Example 2: Find max in array
func findMax(arr)
    if len(arr) == 0
        return nil
    end
    
    let max = arr[0]
    let i = 1
    while i < len(arr)
        if arr[i] > max
            max = arr[i]
        end
        i = i + 1
    end
    return max
end

print findMax([3, 7, 2, 9, 1])     // 9

// Example 3: Check if palindrome
func isPalindrome(str)
    let len_str = len(str)
    let i = 0
    while i < len_str / 2
        if str[i] != str[len_str - 1 - i]
            return false
        end
        i = i + 1
    end
    return true
end

// Example 4: FizzBuzz
print "FizzBuzz:"
for (let i = 1; i <= 20; i = i + 1)
    if i % 15 == 0
        print "FizzBuzz"
    else
        if i % 3 == 0
            print "Fizz"
        else
            if i % 5 == 0
                print "Buzz"
            else
                print i
            end
        end
    end
end
print ""

// Example 5: Prime number check
func isPrime(n)
    if n <= 1
        return false
    end
    if n <= 3
        return true
    end
    if n % 2 == 0 or n % 3 == 0
        return false
    end
    
    let i = 5
    while i * i <= n
        if n % i == 0 or n % (i + 2) == 0
            return false
        end
        i = i + 6
    end
    return true
end

print isPrime(17)              // true
print isPrime(18)              // false
print isPrime(97)              // true
print ""

// ============================================================================
// 21. FUNCTION RETURN TYPES
// ============================================================================
print "=== Testing Function Returns ==="

// Return nothing (nil)
func noReturn()
    print "I return nothing"
end

let result = noReturn()
print result                   // nil

// Early return
func earlyReturn(n)
    if n < 0
        return "negative"
    end
    if n == 0
        return "zero"
    end
    return "positive"
end

print earlyReturn(-5)          // negative
print earlyReturn(0)           // zero
print earlyReturn(5)           // positive
print ""

// ============================================================================
// 22. NESTED STRUCTURES
// ============================================================================
print "=== Testing Nested Structures ==="

// Nested loops
for (let i = 1; i <= 3; i = i + 1)
    for (let j = 1; j <= 3; j = j + 1)
        print i * j
    end
end

// Nested functions
func outer()
    func inner()
        return "inner result"
    end
    return inner()
end

print outer()                  // inner result
print ""

// ============================================================================
// 23. OPERATOR PRECEDENCE
// ============================================================================
print "=== Testing Operator Precedence ==="
print 2 + 3 * 4                // 14 (multiplication first)
print 10 - 2 - 3               // 5 (left associative)
print 2 ** 3 ** 2              // 512 (right associative)
print not false and true       // true
print true or false and false  // true (and before or)
print ""

// ============================================================================
// TEST SUITE COMPLETE
// ============================================================================
print "===== ALL TESTS COMPLETED ====="
print "If you see this message, the interpreter is working correctly!"